<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Performance Per TCO Calculator</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <nav>
      <a href="index.html">Home</a>
      <a href="doc.html">Documentation</a>
      <a href="faq.html">FAQ</a>
      <a href="features.html">On the Horizon</a>
      <a href="feedback.html">Give Feedback</a>
    </nav>
  </header>
  
  <h1>Performance Per TCO Calculator</h1>

  <div id="themeToggleContainer">
    <label class="theme-switch">
      <input type="checkbox" id="themeToggle" onchange="updateAITip()">
      <span class="slider"></span>
      <span class="emoji" id="themeIcon">üåû</span>
    </label>
  </div>

  <section id="about">
    <p>
      This calculator estimates the performance per Total Cost of Ownership (TCO) for GPU-based compute systems.
      It allows you to configure capital and operational cost parameters, choose benchmarks (GROMACS/AMBER),
      and compare GPUs based on their performance per TCO.
    </p>
  </section>

<form id="controls">
<div id="parametersContainer">
  <div id="leftColumn">
    <fieldset>
      <legend>Benchmark and GPU Setup</legend>

      <label for="workload" data-tooltip="Select the benchmark workload: GROMACS or AMBER.">
        Select Workload:
      </label>
      <select id="workload" onchange="updateAITip()">
        <option value="GROMACS">GROMACS</option>
        <option value="AMBER">AMBER</option>
      </select>

      <label for="benchmarkId" data-tooltip="Select a benchmark ID from 1 to 11.">
        Benchmark ID (1‚Äì11):
      </label>
      <input type="range" id="benchmarkId" min="1" max="11" value="4" oninput="updateValue('benchmarkVal', this.value); updateAITip()">
      <span id="benchmarkVal">4</span>
          
            <div style="margin-top: 0px;">
	<button type="button" onclick="exportGPUDataJSON()">‚¨áÔ∏è Export Current Config as JSON</button>
	<button type="button" onclick="exportGPUDataCSV()">‚¨áÔ∏è Export Current Config as CSV</button>
            </div>
            
       <section id="custom-hardware-panel" style="margin-top: 0px;">
            
            <p> Upload Custom GPU and Benchmark Configuration (optional):</p>            
			<label style="font-size: 11px;">Select File Format</label>
            <select id="gpuUploadFormatMain">
              <option value="json">JSON</option>
              <option value="csv">CSV</option>
            </select>
                        
            <input type="file" id="gpuConfigUploadMain" accept=".json,.csv" />
            <button type="button" onclick="handleMainGPUUpload()">Upload GPU Config</button>
            <p id="uploadStatusMain" style="margin-top: 10px;"></p>

          </section>
    </fieldset>

    <fieldset>
      <legend>Initial Setup</legend>

      <label for="total_budget" data-tooltip="Set the total available budget for your project in EUR.">
        Total Budget (‚Ç¨):
        <input type="range" id="total_budget" min="0" max="100000000" value="10000000" step="100" 
               oninput="updateValue('v_budget', this.value); updateAITip()">
        <span id="v_budget">10000000</span>
      </label>    

      <label for="sameGpuCheckbox">
        <input type="checkbox" id="sameGpuCheckbox" onchange="updateAITip()"> Use same number of GPUs for all GPU types
      </label>
    </fieldset>

    <fieldset>
      <legend>Capital Cost Parameters</legend>

      <label for="C_node_server" data-tooltip="Set the server cost per node.">
        Node Server (‚Ç¨):
        <input type="range" id="C_node_server" min="0" max="50000" value="10000" step="5"
               oninput="updateValue('v_node_server', this.value); updateAITip()">
        <span id="v_node_server">10000</span>
      </label>

      <label for="C_node_infra" data-tooltip="Cost for cooling and power distribution units.">
        Node Infrastructure (‚Ç¨):
        <input type="range" id="C_node_infra" min="0" max="25000" value="5000" step="5"
               oninput="updateValue('v_node_infra', this.value); updateAITip()">
        <span id="v_node_infra">5000</span>
      </label>

      <label for="C_node_facility" data-tooltip="Set the cost for data center space and setup in EUR.">
  Node Facility (‚Ç¨):
  <input type="range" id="C_node_facility" min="0" max="25000" value="0" step="5"
         oninput="updateValue('v_node_facility', this.value); updateAITip()">
  <span id="v_node_facility">0</span>
</label>

<label for="C_software" data-tooltip="Set the cost for the software stack, including drivers and software licenses in EUR.">
  Software (‚Ç¨):
  <input type="range" id="C_software" min="0" max="25000" value="5000" step="5"
         oninput="updateValue('v_software', this.value); updateAITip()">
  <span id="v_software">5000</span>
</label>
    </fieldset>
  </div>

  <div id="rightColumn">
    <fieldset>
      <legend>Operational Cost Parameters</legend>

      <label for="C_electricity" data-tooltip="Set the electricity cost in EUR per kWh.">
  Electricity (‚Ç¨/kWh):
  <input type="range" id="C_electricity" min="0" max="5" value="0.21" step="0.01"
         oninput="updateValue('v_electricity', this.value); updateAITip()">
  <span id="v_electricity">0.21</span>
</label>

<label for="C_PUE" data-tooltip="Set the weighted average Power usage effectiveness (PUE) between water cooling PUE and air cooling PUE.">
  PUE:
  <input type="range" id="C_PUE" min="1" max="5" value="1.2" step="0.01"
         oninput="updateValue('v_PUE', this.value); updateAITip()">
  <span id="v_PUE">1.2</span>
</label>

<label for="C_maintenance" data-tooltip="Set the maintenance and support cost per node in EUR per year, including warranty, repairs, and system management.">
  Node Maintenance (‚Ç¨/year):
  <input type="range" id="C_maintenance" min="0" max="5000" value="200" step="5"
         oninput="updateValue('v_maintenance', this.value); updateAITip()">
  <span id="v_maintenance">200</span>
</label>

<label for="system_usage" data-tooltip="Set the total hours of system use per year (max. 24/7 operation).">
  System Usage (hrs/year):
  <input type="range" id="system_usage" min="0" max="8760" value="8760" step="5"
         oninput="updateValue('v_usage', this.value); updateAITip()">
  <span id="v_usage">8760</span>
</label>

<label for="lifetime" data-tooltip="Set the system lifetime in years.">
  System Lifetime (years):
  <input type="range" id="lifetime" min="1" max="100" value="5" step="1"
         oninput="updateValue('v_lifetime', this.value); updateAITip()">
  <span id="v_lifetime">5</span>
</label>

<label for="W_node_baseline" data-tooltip="Set the power consumption per node in watts (excluding GPUs).">
  Node Baseline Power w/o GPUs (W):
  <input type="range" id="W_node_baseline" min="0" max="10000" value="500" step="5"
         oninput="updateValue('v_baseline', this.value); updateAITip()">
  <span id="v_baseline">500</span>
</label>

<label for="C_depreciation" data-tooltip="Set the depreciation cost over time in EUR per year, if applicable.">
  Depreciation (‚Ç¨/year):
  <input type="range" id="C_depreciation" min="0" max="25000" value="0" step="5"
         oninput="updateValue('v_depreciation', this.value); updateAITip()">
  <span id="v_depreciation">0</span>
</label>

<label for="C_subscription" data-tooltip="Set the recurring software subscription costs in EUR per year.">
  Software Subscription (‚Ç¨/year):
  <input type="range" id="C_subscription" min="0" max="25000" value="0" step="5"
         oninput="updateValue('v_subscription', this.value); updateAITip()">
  <span id="v_subscription">0</span>
</label>

<label for="C_uefficiency" data-tooltip="Set the cost due to underutilization of GPU units and inefficiency in EUR per year.">
  Utilization Inefficiency (‚Ç¨/year):
  <input type="range" id="C_uefficiency" min="0" max="25000" value="0" step="5"
         oninput="updateValue('v_uefficiency', this.value); updateAITip()">
  <span id="v_uefficiency">0</span>
</label>

<label for="C_heatreuseperkWh" data-tooltip="Set the revenue generated from heat reuse in EUR per kWh (e.g., district heating revenue).">
  Heat Reuse Revenue (‚Ç¨/kWh):
  <input type="range" id="C_heatreuseperkWh" min="0" max="5" value="0" step="0.1"
         oninput="updateValue('v_heatreuseperkWh', this.value); updateAITip()">
  <span id="v_heatreuseperkWh">0</span>
</label>

<label for="Factor_heatreuse" data-tooltip="Set the factor of the heat that goes to district heating system.">
  Heat Reuse Factor:
  <input type="range" id="Factor_heatreuse" min="0" max="1" value="0" step="0.1"
         oninput="updateValue('v_Factor_heatreuse', this.value); updateAITip()">
  <span id="v_Factor_heatreuse">0</span>
</label>
    </fieldset>
  </div>
</div>

<div id="aiTips" class="ai-tips">
  <h3>Smart Strategy Tip üí°</h3>
  <p id="ai-tip-text">Adjusting values can help optimize your Performance per TCO!</p>
</div>

<fieldset style="margin-top: 0px; text-align: center;">
  <legend>GPU Price Source</legend>
  
  <label style="margin-right: 15px;">
    <input type="radio" name="priceSource" value="static" checked onchange="handlePriceSourceChange()">
    Use Static Prices
  </label>

  <label>
    <input type="radio" name="priceSource" value="live" onchange="handlePriceSourceChange()">
    Use Live Delta Prices
  </label>
</fieldset>

<div style="text-align: center; margin-top: 20px;">
<button type="button" class="medium-button" onclick="saveScenario('scenario1')">
  üì• Save Scenario 1
</button>

  <button type="button" class="medium-button" onclick="calculate(); updateAITip()"> üßÆ Calculate</button>
  <button type="button" class="medium-button" onclick="resetForm(); updateAITip()"> üîÑ Reset All</button> 
  <button type="button" class="medium-button" onclick="promptPassword()">üëÅÔ∏è‚Äçüó®Ô∏èShow Model</button>
  <button type="button" class="medium-button" onclick="generatePDFReport()">üñ®Ô∏è Generate PDF Summary Report</button>
  <button type="button" class="medium-button" onclick="maybeRefreshGPUPrices()">üîÑ Refresh Live GPU Prices</button>
  <!-- Spinner (Hidden by Default) -->
<div id="loading-spinner" style="display: none; margin-top: 10px;">
  <img src="https://upload.wikimedia.org/wikipedia/commons/b/b1/Loading_icon.gif" alt="Loading..." width="40">
</div>

<!-- Last Updated Time -->
<p id="last-updated" style="font-size: 0.9em; margin-top: 10px; color: gray;">
  Last Updated: Never
</p>
</div>
<div id="price-difference-panel" style="margin-top: 20px;">
  <h3>üìà Price Change Summary</h3>
  <ul id="price-difference-list" style="list-style-type: none; padding-left: 0;"></ul>
</div>


</form>

<div id="password-prompt" style="display: none; margin-top: 10px;">
  <label for="password">Enter Password:</label>
  <input type="password" id="password" placeholder="Password">
  <button onclick="validatePassword()">Submit</button>
  <p id="error-message" style="color: red; display: none;">Incorrect password. Try again.</p>
</div>

<div id="output">
  <h2>Results</h2>
  <div id="resultsTable"></div>
  <button id="download-csv" style="display: none;">Download CSV</button>
  <div id="comparison-message-container" class="comparison-message"></div>
  <div id="gpu-chart"></div>
  <div id="stacked-tco-chart"></div>
  <div id="gpuTornadoPlots"></div>
  <div id="sensitivityHeatmap"></div>
  <div id="elasticityTableContainer"></div>
  <button id="download-elasticity-csv" style="display: none;">Download CSV</button>
</div>
<div id="report-container" style="display: none;"></div>


<div id="blog-output-container" style="margin-top: 40px;">
  <h2>üìù Auto-Generated Blog Summary</h2>
  <button class="medium-button" onclick="generateBlogPost()">Generate Blog Summary</button>
  <textarea id="blogOutput" rows="12" style="width: 100%; margin-top: 20px; font-family: monospace;"></textarea>
  <button class="medium-button" onclick="copyBlogText()">Copy to Clipboard</button>
</div>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
<script src="https://cdn.plot.ly/plotly-2.27.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script src="main.js" defer></script>
</body>
</html>
