<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Wattlytics -- Analytics for Smarter Energy Decisions</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <nav>
      <a href="index.html">Home</a>
      <a href="doc.html">Documentation</a>
      <a href="faq.html">FAQ</a>
      <a href="features.html">On the Horizon</a>
      <a href="feedback.html">Give Feedback</a>
      <a href="cite.html">Cite Us</a>
    </nav>
  </header>
  
  <h1>Wattlytics -- Analytics for Smarter Energy Decisions</h1>

  <div id="themeToggleContainer">
    <label class="theme-switch">
      <input type="checkbox" id="themeToggle" onchange="updateAITip()">
      <span class="slider"></span>
      <span class="emoji" id="themeIcon">ğŸŒ</span>
    </label>
  </div>

<section id="about">
  <p>
    Wattlytics is a browserâ€‘based tool for modeling total cost of ownership (TCO), performance, and energy use in GPU-based compute systems.
	  Users can configure cost parameters, select benchmarks (GROMACS/AMBER), and compare GPUs (GH200, H100, L40S, L40, A40, A100, L4)
	  based on performance, power, and costâ€”under realistic workloads and shifting energy/cost conditions.
  </p>

  <h3>ğŸ” Use Cases</h3>
  <ul>
    <li>
      <strong>Current:</strong> Evaluate how various parameters affect key metrics such as performance per TCO, power per TCO, and performance per watt per TCO. For example, compare scenarios where 
      a slower, more power-efficient GPU (Type 1) could outperform a faster, less power-efficient GPU (Type 2) by deploying more units within the same budget and system lifetime.
	Many such decisions still rely on heuristics or vendor specs, without full-system analysisâ€”despite growing needs to decarbonize, use renewables, and reuse waste heat.
    </li>
    <li>
      <strong>Future:</strong> Analyze the impact of adjusting memory/graphics GPU and (un-)core CPU clock frequencies (e.g., running GROMACS/AMBER benchmarks on an A100 at 100 MHz vs. 1.5 GHz) 
      to help users decide whether to prioritize raw performance or optimize for maximum performance per watt. 
    </li>
    <li>
      <strong>Tool Focus:</strong> This is a tool for exploring the parameter space and analyzing sensitivity, rather than for direct procurement planning, as procurement involves many dynamic factors that cannot be captured by a single tool. Accurately modeling tradeâ€‘offs between performance, power consumption, cost, and emissions is crucial for researchers, data center operators, and decision makers. Therefore, the broader goal is to evolve Wattlytics into a flexible, research-grade platform that models real-world performance and energy tradeoffs, supports exploring realistic cluster design, scheduling and scaling decisions under uncertainty, inefficiency, and constraints, with collaborative and programmatic access.
    </li>
  </ul>
</section>


<form id="controls">
<div id="parametersContainer">
  <div id="leftColumn">
    <fieldset>
      <legend>Benchmark and GPU Setup</legend>

      <label for="workload" data-tooltip="Select the benchmark workload: GROMACS or AMBER.">
        Select Workload:
      </label>
      <select id="workload" onchange="updateAITip()">
        <option value="GROMACS">GROMACS</option>
        <option value="AMBER">AMBER</option>
      </select>

      <label for="benchmarkId" data-tooltip="Select a benchmark ID from 1 to 11.">
        Benchmark ID (1â€“11):
      </label>
      <input type="range" id="benchmarkId" min="1" max="11" value="4" oninput="updateValue('benchmarkVal', this.value); updateAITip()">
      <span id="benchmarkVal">4</span>
          
            <div style="margin-top: 0px;">
	<button type="button" onclick="exportGPUDataJSON()">â¬‡ï¸ Export Current Config as JSON</button>
	<button type="button" onclick="exportGPUDataCSV()">â¬‡ï¸ Export Current Config as CSV</button>
            </div>
            
       <section id="custom-hardware-panel" style="margin-top: 0px;">
            
            <p> Upload Custom GPU and Benchmark Configuration (optional):</p>            
			<label style="font-size: 11px;">Select File Format</label>
            <select id="gpuUploadFormatMain">
              <option value="json">JSON</option>
              <option value="csv">CSV</option>
            </select>
                        
            <input type="file" id="gpuConfigUploadMain" accept=".json,.csv" />
            <button type="button" onclick="handleMainGPUUpload()">Upload GPU Config</button>
            <p id="uploadStatusMain" style="margin-top: 10px;"></p>

          </section>
    </fieldset>

<fieldset>
  <legend>Deployment Scenarios for the Limiting Factors</legend>

  <!-- Fix Budget -->
  <label>
    <input type="radio" name="calculationMode" value="budget" checked>
    Fix Budget
  </label>
  <div class="mode-slider" id="slider_budget">
    <input type="range" id="total_budget" min="0" max="100000000" value="10000000" step="100"
           oninput="updateValue('v_budget', this.value); updateAITip()">
    <span id="v_budget">10000000</span>
  </div>

  <!-- Fix Total Power -->
  <label>
    <input type="radio" name="calculationMode" value="power">
    Fix Total Power
  </label>
  <div class="mode-slider" id="slider_power">
    <input type="range" id="max_total_power" min="0" max="5000" value="1000" step="10"
           oninput="updateValue('v_max_power', this.value); updateAITip()">
    <span id="v_max_power">1000</span>
  </div>

  <!-- Fix Performance -->
  <label>
    <input type="radio" name="calculationMode" value="performance">
    Fix Total Performance
  </label>
  <div class="mode-slider" id="slider_performance">
    <input type="range" id="target_performance" min="1e6" max="1e10" value="1e9" step="1e6"
           oninput="updateValue('v_perf', this.value); updateAITip()">
    <span id="v_perf">1e9</span>
  </div>

  <label>
    <input type="radio" name="calculationMode" value="budget">
    Fix GPU Count
  </label>
  <div class="mode-slider" id="slider_gpu">
    <input type="range" id="same_n_gpu" min="1" max="1024" value="240" step="5"
           oninput="updateValue('v_same_n_gpu', this.value); updateAITip()">
    <span id="v_same_n_gpu">240</span>
  </div>
</fieldset>

	  <fieldset>
  <legend>Initial Setup</legend>
  <!-- Global Uncertainty -->
  <label>
    Global Uncertainty (Uniform Â±%):
    <input type="range" id="globalUncertainty" min="0" max="100" step="1" value="20">
    <span id="v_globalUncertainty">20</span>%
    <span id="globalLockIcon" style="margin-left:10px; font-size:1.2em; display:none;">ğŸ”’</span>
  </label>
</fieldset>


    <fieldset>
  <legend>Capital Cost Parameters</legend>

  <label for="C_node_server" data-tooltip="Set the server cost per node.">
    Node Server (â‚¬):
    <input type="range" id="C_node_server" min="0" max="400000" value="10000" step="5"
           oninput="updateValue('v_node_server', this.value); updateAITip()">
    <span id="v_node_server">10000</span>

    <br>
    <small>
      Uncertainty Â±%
      <input type="range" class="paramUncertainty" data-param="C_node_server"
             min="0" max="100" step="1" value="15">
      <span class="uncValue">15</span>%
    </small>
  </label>

  <label for="C_node_infra" data-tooltip="Set the cost for cooling and power distribution units.">
    Node Infrastructure (â‚¬):
    <input type="range" id="C_node_infra" min="0" max="25000" value="5000" step="5"
           oninput="updateValue('v_node_infra', this.value); updateAITip()">
    <span id="v_node_infra">5000</span>

    <br>
    <small>
      Uncertainty Â±%
      <input type="range" class="paramUncertainty" data-param="C_node_infra"
             min="0" max="100" step="1" value="15">
      <span class="uncValue">15</span>%
    </small>
  </label>

  <label for="C_node_facility" data-tooltip="Set the cost for data center space and setup in EUR.">
    Node Facility (â‚¬):
    <input type="range" id="C_node_facility" min="0" max="25000" value="0" step="5"
           oninput="updateValue('v_node_facility', this.value); updateAITip()">
    <span id="v_node_facility">0</span>

    <br>
    <small>
      Uncertainty Â±%
      <input type="range" class="paramUncertainty" data-param="C_node_facility"
             min="0" max="100" step="1" value="15">
      <span class="uncValue">15</span>%
    </small>
  </label>

  <label for="C_software" data-tooltip="Set the cost for the software stack, including drivers and software licenses in EUR.">
    Software (â‚¬):
    <input type="range" id="C_software" min="0" max="25000" value="5000" step="5"
           oninput="updateValue('v_software', this.value); updateAITip()">
    <span id="v_software">5000</span>

    <br>
    <small>
      Uncertainty Â±%
      <input type="range" class="paramUncertainty" data-param="C_software"
             min="0" max="100" step="1" value="10">
      <span class="uncValue">10</span>%
    </small>
  </label>
</fieldset>
  </div>

  <div id="rightColumn">
    <fieldset>
  <legend>Operational Cost Parameters</legend>

  <label for="C_electricity" data-tooltip="Set the electricity cost in EUR per kWh.">
    Electricity (â‚¬/kWh):
    <input type="range" id="C_electricity" min="0" max="5" value="0.21" step="0.01"
           oninput="updateValue('v_electricity', this.value); updateAITip()">
    <span id="v_electricity">0.21</span>

    <br>
    <small>
      Uncertainty Â±%
      <input type="range" class="paramUncertainty" data-param="C_electricity"
             min="0" max="100" step="1" value="25">
      <span class="uncValue">25</span>%
    </small>
  </label>

  <label for="C_PUE" data-tooltip="Set the weighted average Power usage effectiveness (PUE) between water cooling PUE and air cooling PUE.">
    PUE:
    <input type="range" id="C_PUE" min="1" max="5" value="1.2" step="0.01"
           oninput="updateValue('v_PUE', this.value); updateAITip()">
    <span id="v_PUE">1.2</span>

    <br>
    <small>
      Uncertainty Â±%
      <input type="range" class="paramUncertainty" data-param="C_PUE"
             min="0" max="100" step="1" value="8">
      <span class="uncValue">8</span>%
    </small>
  </label>

  <label for="C_maintenance" data-tooltip="Set the maintenance and support cost per node in EUR per year, including warranty, repairs, and system management.">
    Node Maintenance (â‚¬/year):
    <input type="range" id="C_maintenance" min="0" max="5000" value="200" step="5"
           oninput="updateValue('v_maintenance', this.value); updateAITip()">
    <span id="v_maintenance">200</span>

    <br>
    <small>
      Uncertainty Â±%
      <input type="range" class="paramUncertainty" data-param="C_maintenance"
             min="0" max="100" step="1" value="30">
      <span class="uncValue">30</span>%
    </small>
  </label>

  <label for="system_usage" data-tooltip="Set the total hours of system use per year (max. 24/7 operation).">
    System Usage (hrs/year):
    <input type="range" id="system_usage" min="0" max="8760" value="8760" step="5"
           oninput="updateValue('v_usage', this.value); updateAITip()">
    <span id="v_usage">8760</span>

    <br>
    <small>
      Uncertainty Â±%
      <input type="range" class="paramUncertainty" data-param="system_usage"
             min="0" max="100" step="1" value="20">
      <span class="uncValue">20</span>%
    </small>
  </label>

  <label for="lifetime" data-tooltip="Set the system lifetime in years.">
    System Lifetime (years):
    <input type="range" id="lifetime" min="1" max="100" value="5" step="1"
           oninput="updateValue('v_lifetime', this.value); updateAITip()">
    <span id="v_lifetime">5</span>

    <br>
    <small>
      Uncertainty Â±%
      <input type="range" class="paramUncertainty" data-param="lifetime"
             min="0" max="100" step="1" value="30">
      <span class="uncValue">30</span>%
    </small>
  </label>

  <label for="W_node_baseline" data-tooltip="Set the power consumption per node in watts (excluding GPUs).">
    Node Baseline Power w/o GPUs (W):
    <input type="range" id="W_node_baseline" min="0" max="10000" value="500" step="5"
           oninput="updateValue('v_baseline', this.value); updateAITip()">
    <span id="v_baseline">500</span>

    <br>
    <small>
      Uncertainty Â±%
      <input type="range" class="paramUncertainty" data-param="W_node_baseline"
             min="0" max="100" step="1" value="10">
      <span class="uncValue">10</span>%
    </small>
  </label>

  <label for="C_depreciation" data-tooltip="Set the depreciation cost over time in EUR per year, if applicable.">
    Depreciation (â‚¬/year):
    <input type="range" id="C_depreciation" min="0" max="25000" value="0" step="5"
           oninput="updateValue('v_depreciation', this.value); updateAITip()">
    <span id="v_depreciation">0</span>

    <br>
    <small>
      Uncertainty Â±%
      <input type="range" class="paramUncertainty" data-param="C_depreciation"
             min="0" max="100" step="1" value="20">
      <span class="uncValue">20</span>%
    </small>
  </label>

  <label for="C_subscription" data-tooltip="Set the recurring software subscription costs in EUR per year.">
    Software Subscription (â‚¬/year):
    <input type="range" id="C_subscription" min="0" max="25000" value="0" step="5"
           oninput="updateValue('v_subscription', this.value); updateAITip()">
    <span id="v_subscription">0</span>

    <br>
    <small>
      Uncertainty Â±%
      <input type="range" class="paramUncertainty" data-param="C_subscription"
             min="0" max="100" step="1" value="5">
      <span class="uncValue">5</span>%
    </small>
  </label>

  <label for="C_uefficiency" data-tooltip="Set the cost due to underutilization of GPU units and inefficiency in EUR per year.">
    Utilization Inefficiency (â‚¬/year):
    <input type="range" id="C_uefficiency" min="0" max="25000" value="0" step="5"
           oninput="updateValue('v_uefficiency', this.value); updateAITip()">
    <span id="v_uefficiency">0</span>

    <br>
    <small>
      Uncertainty Â±%
      <input type="range" class="paramUncertainty" data-param="C_uefficiency"
             min="0" max="100" step="1" value="25">
      <span class="uncValue">25</span>%
    </small>
  </label>

  <label for="C_heatreuseperkWh" data-tooltip="Set the revenue generated from heat reuse in EUR per kWh (e.g., district heating revenue).">
    Heat Reuse Revenue (â‚¬/kWh):
    <input type="range" id="C_heatreuseperkWh" min="0" max="5" value="0" step="0.1"
           oninput="updateValue('v_heatreuseperkWh', this.value); updateAITip()">
    <span id="v_heatreuseperkWh">0</span>

    <br>
    <small>
      Uncertainty Â±%
      <input type="range" class="paramUncertainty" data-param="C_heatreuseperkWh"
             min="0" max="100" step="1" value="60">
      <span class="uncValue">60</span>%
    </small>
  </label>

	<label for="Factor_heatreuse" data-tooltip="Set the factor of the heat that goes to district heating system.">
  Heat Reuse Factor:
  <input type="range" id="Factor_heatreuse" min="0" max="1" value="0" step="0.1"
         oninput="updateValue('v_Factor_heatreuse', this.value); updateAITip()">
  <span id="v_Factor_heatreuse">0</span>
    <br>
    <small>
      Uncertainty Â±%
      <input type="range" class="paramUncertainty" data-param="Factor_heatreuse"
             min="0" max="100" step="1" value="60">
      <span class="uncValue">60</span>%
	</small>
	
</label>
</fieldset>
  </div>
</div>
	
<div id="aiTips" class="ai-tips">
  <h3>Smart Strategy Tip ğŸ’¡</h3>
  <p id="ai-tip-text">Adjusting values can help optimize your Performance per TCO!</p>
</div>

<fieldset style="margin-top: 0px; text-align: center;">
  <legend>GPU Price Source</legend>
  
  <label style="margin-right: 15px;">
    <input type="radio" name="priceSource" value="static" checked onchange="handlePriceSourceChange()">
    Use Static Prices
  </label>

  <label>
    <input type="radio" name="priceSource" value="live" onchange="handlePriceSourceChange()">
    Use Live Delta Prices
  </label>

  <!-- Moved Refresh button, Spinner, and Last Updated section next to Live Delta Prices -->
  <div id="refresh-container" style="display: inline-block; text-align: center; margin-top: 10px;">
    <!-- Refresh Button -->
    <button type="button" onclick="maybeRefreshGPUPrices()"> ğŸ”„ Refresh Live GPU Prices </button>
    
    <!-- Spinner (Hidden by Default) -->
    <div id="loading-spinner" style="display: none; margin-bottom: 10px;">
      <img src="https://upload.wikimedia.org/wikipedia/commons/b/b1/Loading_icon.gif" alt="Loading..." width="40">
    </div>
    
    <!-- Last Updated Time -->
    <p id="last-updated" style="font-size: 0.9em; color: gray; margin-top: 5px;">
      Last Updated: Never
    </p>
  </div>

<div style="margin-bottom: 1em;">
  <label for="priceMetric">Select metric:</label>
  <select id="priceMetric">
  	<option value="livePrice" selected>Live GPU Price (â‚¬)</option>
    <option value="percentDiff">% Price Difference (Live vs Static)</option>
  </select>
</div>

<canvas id="priceChart" width="100%" height="50"></canvas>

<div style="margin: 10px 0; text-align: center;">
  <button type="button" onclick="exportChartImage()">ğŸ“¸ Export Image</button>
  <button type="button" onclick="exportChartCSV()">ğŸ“„ Export CSV</button>
  <button type="button" onclick="zoomChart(1.2)">â• Zoom In</button>
  <button type="button" onclick="zoomChart(0.8)">â– Zoom Out</button>
  <button type="button" onclick="resetZoom()">ğŸ”„ Reset Zoom</button>
</div>

<div id="price-difference-panel" style="margin-top: 20px;">
  <h3>ğŸ“ˆ Price Change Summary</h3>
  
  <div style="display: flex; gap: 20px; align-items: flex-start; flex-wrap: wrap;">
    <!-- Price Difference List -->
    <ul id="price-difference-list" style="list-style-type: none; padding-left: 0; flex: 1; min-width: 250px;"></ul>
    
    <!-- Chart -->
    <div style="flex: 1; min-width: 250px;">
      <canvas id="priceChart"></canvas>
    </div>
  </div>
</div>

<div id="preset-profile-container" style="margin-top: 20px; border: 1px solid #ccc; padding: 10px; border-radius: 8px;">
  <label for="preset-profile"><strong>ğŸ› Load Preset Cluster Profile:</strong></label>
  <select id="preset-profile" onchange="applyPresetProfile()" style="margin-top: 5px;">
    <option value="">-- Select a Profile --</option>
    <option value="Alex">NHR@FAU Alex Cluster (A100, A40)</option>
    <option value="Helma">NHR@FAU Helma Cluster (H100)</option>
  </select>
</div>

</fieldset>
</form>
<div style="text-align: center; margin-top: 20px;">
  <button type="button" class="medium-button" onclick="calculate(); updateAITip()"> ğŸ§® Calculate</button>
  <button type="button" class="medium-button" onclick="resetForm(); updateAITip()"> ğŸ”„ Reset All</button> 
  <button type="button" class="medium-button" onclick="promptPassword()">ğŸ‘ï¸â€ğŸ—¨ï¸Show Model</button>
  <button id="shareBtn" type="button" class="medium-button">ğŸ”— Share Results</button>
  <button type="button" class="medium-button" onclick="generatePDFReport()">ğŸ–¨ï¸ Download PDF Summary Report</button>
  <div id="password-prompt" style="display: none; margin-top: 10px;">
  <label for="password">Enter Password:</label>
  <input type="password" id="password" placeholder="Password">
  <button onclick="validatePassword()">Submit</button>
  <p id="error-message" style="color: red; display: none;">Incorrect password. Try again.</p>
</div>
</div>


<div style="text-align: center; margin-top: 20px;">
  <h3>ğŸ“Š Scenario Comparison (What-if Simulation)</h3>
<button type="button" class="medium-button" onclick="saveScenario('scenario1')"> ğŸ“¥ Save Scenario 1 </button>
<button type="button" class="medium-button" onclick="saveScenario('scenario2')"> ğŸ“¥ Save Scenario 2 </button>
<button type="button" class="medium-button" onclick="compareScenarios()"> ğŸ“Š Compare Scenarios </button>
<button type="button" class="medium-button" onclick="downloadComparisonPDF()"> ğŸ–¨ï¸ Download PDF Comparison Report </button>
<div id="scenario-comparison" style="margin-top: 20px;"></div>
</div>

<!-- In the input section -->
<div id="input" style="text-align: center; margin-top: 20px;">
  <h3>ğŸ”¥ Benchmark Ã— GPU Performance and Power</h3>
  <button type="button" class="medium-button" onclick="renderPerfPowerHeatmaps()"> ğŸ”˜ Display Heatmaps</button>
  <div id="gpuPerfPowerHeatmap"></div> <!-- changed ID -->
</div>

<!-- In the output section -->
<div id="output" style="margin-top: 40px; ">
  <h2>Results</h2>
  <div id="resultsTable"></div>
  <button id="download-csv" style="display: none;">Download CSV</button>
  <div id="comparison-message-container" class="comparison-message"></div>

<div style="text-align: center;">
  <h2>Output by GPU Type: GPU Count, Performance per TCO, Power per TCO, Performance per watt per TCO </h2>
    <div id="charts-container" style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">
    <div id="gpu-chart" style="flex: 1 1 300px; min-width: 300px; max-width: 400px;"></div>
    <div id="power-chart" style="flex: 1 1 300px; min-width: 300px; max-width: 400px;"></div>
    <div id="perf-watt-chart" style="flex: 1 1 300px; min-width: 300px; max-width: 400px;"></div>
  </div>
</div>

<div style="text-align: center;">
  <h2>TCO Breakdown (Capital vs Operational costs) </h2>
<div id="tco-chart-container" style="display: flex; flex-direction: row; gap: 0px; flex-wrap: nowrap; justify-content: space-between; align-items: flex-start; margin-top: 40px;"> 
  <div style="flex: 0 0 65%; min-width: 700px;">
    <div id="stacked-tco-chart"></div>
  </div>
  
  <div style="flex: 0 0 35%; min-width: 0; margin-top: 60px;">
    <div id="pie-tco-chart" style="margin-top: 0; max-height: 1000px; overflow-y: auto;"></div>
  </div>
</div>
</div>

<div style="text-align: center;">
  <h2>Sensitivity and uncertainty modeling (cross-GPU view) </h2>
  <div id="sensitivityHeatmaps" style="width:100%;"></div>
</div>

<div style="text-align: center;">
  <h2>Sensitivity and uncertainty modeling (Per-GPU view) </h2>
  <div id="gpuTornadoPlots"></div>
</div>
</div>
<div id="report-container" style="display: none;"></div>


<div id="blog-output-container" style="margin-top: 40px;">
  <h2>ğŸ“ Auto-Generated Blog Summary</h2>
  <button class="medium-button" onclick="generateBlogPost()">Generate Blog Summary</button>
  <textarea id="blogOutput" rows="12" style="width: 100%; margin-top: 20px; font-family: monospace;"></textarea>
  <button class="medium-button" onclick="copyBlogText()">Copy to Clipboard</button>
</div>


<!-- Chart.js (only load once, UMD version) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<!-- Chart.js plugins -->
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>

<!-- Other libraries -->
<script src="https://cdn.plot.ly/plotly-2.27.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<!-- Register plugins -->
<script>
  Chart.register(ChartZoom);
</script>

<!-- Scripts -->
<script src="main.js" defer></script>
<script src="footer.js" defer></script>

</body>
</html>
