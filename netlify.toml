[functions]
  directory = "netlify/functions"
  node_bundler = "esbuild"
  external_node_modules = ["@octokit/rest"]

[build]
  command = "npm install"

# 1. Bypass redirect for all specific static asset files (.js, .css, etc.)
# This ensures that /s/main.js loads /main.js and /s/footer.js loads /footer.js
[[redirects]]
  from = "/s/*.js"
  to = "/:splat"  # :splat will contain the part matched by * (e.g., main.js)
  status = 200
  force = false

[[redirects]]
  from = "/s/*.css"
  to = "/:splat"
  status = 200
  force = false

# 2. Rewrite all other /s/* paths to index.html for client-side routing
# This handles the actual shared links like /s/b1234.
[[redirects]]
  from = "/s/*"
  to = "/index.html"
  status = 200
  force = false
